<!-- home.html -->

<style>
  /* ====== Fonts: Saudi Regular / SemiBold ====== */
  @font-face {
    font-family: 'Saudi';
    src: url('Saudi-Regular.ttf') format('truetype');
    font-weight: 400;
    font-style: normal;
    font-display: swap;
  }
  @font-face {
    font-family: 'Saudi';
    src: url('Saudi-SemiBold.ttf') format('truetype');
    font-weight: 600;
    font-style: normal;
    font-display: swap;
  }

  /* ====== Design System / Theme ====== */
:root[data-theme="light"] {
  --header-bg:#f7f8f7;
  --header-fg:#0b0f0c;
  --green:#126b3a;
  --green-2:#0f5d33;
  --gold:#d4b26a;
  --accent: var(--gold);
  --ink:#0b0f0c;
  --bg:#f7f8f7;
  --card:#ffffff;
  --muted:#6b7280;
  --radius:16px;
  --shadow:0 8px 24px rgba(0,0,0,.06);
}
  /* Ø«ÙŠÙ… Ø¯Ø§ÙƒÙ† */


  /* Ø«ÙŠÙ… Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ÙˆØ·Ù†ÙŠ */
  :root[data-theme="national"] {
  --bg:#09472d;
  --card:#ffffff;
  --ink:#ffffff;
  --green:#126b3a;
  --gold:#d8c08a;
  --accent: var(--gold);
  --header-bg:#038750;
  --header-fg:#ffffff;
}
:root[data-theme="dark"] {
  --bg:#0f1414;
  --card:#121818;
  --ink:#f5f5f5;
  --muted:#c6d0d0;
  --green:#126b3a;
  --gold:#d4b26a;
  --accent: var(--gold);
  --header-bg:#0f1414;
  --header-fg:#ffffff;
}

  html, body { height:100% }
  body {
    font-family: 'Saudi', 'Tajawal', system-ui, Arial, sans-serif;
    background:var(--bg);
    color:var(--ink);
    margin:0;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }

  a { color:var(--green); }
  .container { max-width:1100px; margin-inline:auto; padding:16px; }

  .card {
    background:var(--card);
    border:1px solid #e8ece8;
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    padding:20px;
    color:var(--ink);
  }

  .hero {
    display:grid; gap:12px; margin:12px 0 16px; padding:18px 20px;
    background:linear-gradient(180deg, rgba(18,107,58,.06), transparent);
    border-radius:var(--radius);
  }
  .hero h1 { font-weight:600; letter-spacing:.2px; margin:6px 0 0; color:var(--ink); }
  .hero p { margin:0; color:var(--muted); }

  .kpis { display:flex; gap:10px; flex-wrap:wrap }
  .kpi {
    background:var(--card);
    border:1px solid #e8ece8;
    border-radius:12px;
    padding:10px 12px;
    font-size:13px;
    color:var(--ink);
  }

  /* Azkar */
  .azkar { display:grid; gap:10px }
  .azkar .controls { display:flex; gap:8px; flex-wrap:wrap }
  .btn {
    appearance:none; border:1px solid #e5e7eb;
    background:var(--card); color:var(--ink);
    padding:10px 14px; border-radius:999px;
    cursor:pointer; font-weight:600; font-size:14px;
  }
  .btn.primary { background:var(--green); color:#fff; border-color:var(--green-2) }
  .btn.ghost { background:transparent; color:var(--ink); }
  .btn:disabled { opacity:.5; cursor:not-allowed }
  .segment {
    display:flex; gap:8px; background:var(--card);
    border:1px solid #e5e7eb; border-radius:999px; padding:6px;
  }
  .segment button {
    border:none; background:transparent; color:var(--ink);
    padding:8px 12px; border-radius:999px; cursor:pointer; font-weight:600;
  }
  .segment button[aria-pressed="true"] { background:var(--green); color:#fff; }

  /* Sections */
  section { margin-top:22px; color:var(--ink); }
  section h2 { font-weight:600; letter-spacing:.15px; color:var(--ink); }
  .grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:16px }
  @media (max-width:840px){ .grid-2 { grid-template-columns:1fr } }

  /* Forms */
  .field { display:grid; gap:6px }
  .field input,.field textarea,.field select {
    padding:12px 12px; border:1px solid #dfe5df;
    border-radius:12px; font-size:15px; background:var(--card);
    color:var(--ink);
  }
  .field small { color:var(--muted) }
  .inline { display:flex; gap:10px; flex-wrap:wrap; align-items:center }

  /* Footer spacing placeholder */
  .spacer { height:32px }

  /* SoundCloud player UI */
  .sc-player {
    display:grid; gap:10px; background:var(--card);
    border:1px solid #e5e7eb; border-radius:12px; padding:12px;
    color:var(--ink);
  }
  :root[data-theme="national"] .sc-player { border-color:#dfe5df }

  .sc-head { display:flex; align-items:center; justify-content:space-between; gap:10px }
  .sc-title { font-weight:700; color:var(--ink); }
  .sc-time { font-variant-numeric:tabular-nums; color:var(--muted); font-size:13px }

  .sc-bar { position:relative; height:10px; border-radius:999px; cursor:pointer; user-select:none }
  .sc-bar__bg { position:absolute; inset:0; border-radius:999px; background:rgba(0,0,0,.08) }
  .sc-bar__fill { position:absolute; inset:0 auto 0 0; width:0%; border-radius:999px; background:linear-gradient(90deg, var(--accent), rgba(212,178,106,.6)) }
  .sc-bar__knob { position:absolute; top:50%; transform:translate(-50%,-50%); width:14px; height:14px; border-radius:999px; background:#fff; border:2px solid var(--accent); box-shadow:0 1px 3px rgba(0,0,0,.2) }

  .sc-controls { display:flex; gap:8px; flex-wrap:wrap }
  .icon-btn {
    appearance:none; border:1px solid #e5e7eb;
    background:var(--card); color:var(--ink);
    width:42px; height:42px; border-radius:999px; cursor:pointer;
    display:inline-flex; align-items:center; justify-content:center;
    transition:transform .12s ease, box-shadow .12s ease, border-color .12s ease;
  }
  .icon-btn .ic { width:20px; height:20px; display:block }
  .icon-btn:hover { transform:translateY(-1px); box-shadow:0 6px 16px rgba(0,0,0,.06) }
  .icon-btn:active { transform:translateY(0); box-shadow:none }
  .icon-btn:disabled { opacity:.5; cursor:not-allowed; box-shadow:none }

  .icon-btn.primary { background:var(--green); color:#fff; border-color:var(--green-2) }
  .icon-btn.ghost { background:transparent; color:var(--ink) }

  @media (prefers-reduced-motion: reduce) {
    .icon-btn { transition:none; }
  }

  /* Ø¥Ø®ÙØ§Ø¡ iframe Ù…Ø¹ Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ */
  .visually-hidden-offscreen {
    position: fixed;
    left: -10000px;
    top: 0;
    width: 320px;
    height: 180px;
    border: 0;
    opacity: 0;
    pointer-events: none;
    visibility: visible !important;
  }
  :root[data-theme="national"] .actions .btn.ghost,
:root[data-theme="national"] .actions .btn.hamburger {
  background:#ffffff22;   /* Ø®Ù„ÙÙŠØ© Ø´ÙØ§ÙØ© ÙØ§ØªØ­Ø© */
  color:#fff;             /* Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø¨ÙŠØ¶Ø§Ø¡ */
  border-color:#ffffff55; /* Ø­Ø¯ÙˆØ¯ Ø£ÙˆØ¶Ø­ */
}

:root[data-theme="national"] .actions .btn.ghost:hover,
:root[data-theme="national"] .actions .btn.hamburger:hover {
  background:#ffffff44;   /* hover Ø£ÙØªØ­ */
}
:root[data-theme="national"] .menu a {
  color: var(--accent); /* Ø§Ù„Ø°Ù‡Ø¨ÙŠ ÙŠØ¨Ø§Ù† Ø£ÙˆØ¶Ø­ */
}
:root[data-theme="national"] .menu a:hover {
  background: rgba(255,255,255,.12);
  color: #fff; /* ÙŠØ±Ø¬Ø¹ Ø£Ø¨ÙŠØ¶ Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ± */
}

:root[data-theme="national"] .mobile-menu a {
  color: var(--accent);
}
:root[data-theme="national"] .mobile-menu a:hover {
  background: rgba(255,255,255,.12);
  color: #fff;
}
/* Ø«ÙŠÙ… national: Ù†ØµÙˆØµ Ø§Ù„ÙƒØ±ÙˆØª Ø¯Ø§ÙƒÙ†Ø©ØŒ ÙˆØ§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± */
:root[data-theme="national"] .card {
  color: #0b0f0c; /* Ù†Øµ Ø£Ø³Ø§Ø³ÙŠ Ø¯Ø§ÙƒÙ† Ø¯Ø§Ø®Ù„ Ø§Ù„ÙƒØ±ÙˆØª ÙÙ‚Ø· */
}

/* Ø«Ø¨Ù‘ØªÙŠ Ù„ÙˆÙ† Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„ÙƒØ±ÙˆØª Ù…Ø«Ù„ Ù…Ø§ Ù‡Ùˆ (ÙŠÙ…Ø´ÙŠ Ø¹Ù„Ù‰ h1/h2/h3 ÙÙ‚Ø·) */
:root[data-theme="national"] .card h1,
:root[data-theme="national"] .card h2,
:root[data-theme="national"] .card h3 {
  color: var(--ink); /* Ù†ÙØ³ Ù„ÙˆÙ† Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙŠ Ø§Ù„Ø«ÙŠÙ… */
}

/* Ù„Ùˆ ØªØ¨ÙŠÙ† Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù†Øµ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø¯Ø§Ø®Ù„ Ø§Ù„ÙƒØ±Øª ØªÙƒÙˆÙ† Ø£ÙˆØ¶Ø­ Ø¨Ø¹Ø¯ */
:root[data-theme="national"] .card p,
:root[data-theme="national"] .card li,
:root[data-theme="national"] .card small,
:root[data-theme="national"] .card label {
  color: #0b0f0c; /* ÙŠØ¶Ù…Ù† ÙˆØ¶ÙˆØ­ Ø§Ù„Ù†ØµÙˆØµ ØºÙŠØ± Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† */
}

/* Ù…Ø¯Ø®Ù„Ø§Øª/Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¯Ø§Ø®Ù„ Ø§Ù„ÙƒØ±Øª ØªÙƒØªØ¨ Ø¨Ù„ÙˆÙ† Ø¯Ø§ÙƒÙ† Ø£ÙŠØ¶Ù‹Ø§ */
:root[data-theme="national"] .card input,
:root[data-theme="national"] .card textarea,
:root[data-theme="national"] .card select {
  color: #0b0f0c;
}
/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙƒØ±ÙˆØª ÙÙŠ Ø«ÙŠÙ… national */
:root[data-theme="national"] .card .btn {
  background:#f8f8f8;    /* Ø®Ù„ÙÙŠØ© Ø£ÙØªØ­ */
  color:#0b0f0c;         /* Ù†Øµ Ø¯Ø§ÙƒÙ† */
  border-color:#ccc;     /* Ø­Ø¯ÙˆØ¯ ÙˆØ§Ø¶Ø­Ø© */
}

:root[data-theme="national"] .card .btn.primary {
  background: var(--green); /* Ø£Ø®Ø¶Ø± Ø±Ø¦ÙŠØ³ÙŠ */
  color:#fff;               /* Ù†Øµ Ø£Ø¨ÙŠØ¶ */
  border-color: var(--green-2);
}

:root[data-theme="national"] .card .btn:hover {
  background:#eee; /* hover Ø£ØºÙ…Ù‚ Ø´ÙˆÙŠ */
}
/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø«ÙŠÙ… national */
:root[data-theme="national"] .card .icon-btn {
  background:#f8f8f8;     /* Ø®Ù„ÙÙŠØ© ÙØ§ØªØ­Ø© */
  color:#0b0f0c;          /* Ù†Øµ ØºØ§Ù…Ù‚ */
  border-color:#ccc;
}

:root[data-theme="national"] .card .icon-btn.primary {
  background: var(--green); /* Ø£Ø®Ø¶Ø± */
  color:#fff;               /* Ù†Øµ Ø£Ø¨ÙŠØ¶ */
  border-color: var(--green-2);
}

:root[data-theme="national"] .card .icon-btn.ghost {
  background:transparent;
  color:#0b0f0c;           /* ÙŠØ®Ù„ÙŠ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© ØºØ§Ù…Ù‚Ø© */
}

:root[data-theme="national"] .card .icon-btn:hover {
  background:#eee;
}
/* Ù†Øµ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØµØ¨Ø§Ø­/Ø§Ù„Ù…Ø³Ø§Ø¡ ÙÙŠ Ø«ÙŠÙ… national */
:root[data-theme="national"] .segment button {
  color:#0b0f0c; /* Ù†Øµ Ø¯Ø§ÙƒÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„ÙØ§ØªØ­Ø© */
}

:root[data-theme="national"] .segment button[aria-pressed="true"] {
  background: var(--green);
  color:#fff; /* Ù†Øµ Ø£Ø¨ÙŠØ¶ Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ */
}
</style>

<main class="container" id="top">

  <!-- 1) HERO -->
  <div class="hero" role="region" aria-label="Ù…Ù‚Ø¯Ù…Ø©">
    <h1>ØªÙˆØ²ÙŠØ¹Ø§Øª Ø£Ù†ÙŠÙ‚Ø© Ù„Ù„ÙŠÙˆÙ… Ø§Ù„ÙˆØ·Ù†ÙŠâ€¦ ÙˆØµØ§Ù„Ø­Ø© Ù„ÙƒÙ„ Ø§Ù„Ø³Ù†Ø© ğŸ</h1>
    <p>Ù†ÙˆØ¹Ø§Ù† ÙÙ‚Ø· Ù„Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„Ø·Ù„Ø¨: <strong>Ù…Ø¯Ø§Ù„ÙŠØ©</strong> Ùˆ<strong>ØªØ¹Ù„ÙŠÙ‚Ø© Ø³ÙŠØ§Ø±Ø©</strong>. Ø§Ø®ØªØ±ØŒ Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ù†Ù‚Ø´ØŒ ÙˆØ£Ø±Ø³Ù„ Ø§Ù„Ø·Ù„Ø¨ ÙÙˆØ±Ù‹Ø§.</p>
  </div>

  <!-- 2) Ø§Ù„Ø£Ø°ÙƒØ§Ø± -->
<div class="azkar" id="azkar">
  <div class="sc-player card" dir="rtl" aria-label="Ù…Ø´ØºÙ‘Ù„ Ø§Ù„Ø£Ø°ÙƒØ§Ø±">
    <div class="sc-head">
      <div class="sc-title" id="scTitle">Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­</div>
      <div class="sc-time"><span id="tNow">00:00</span> / <span id="tTotal">00:00</span></div>
    </div>

    <div class="controls">
      <div class="segment" role="tablist">
        <button id="tabMorning" aria-selected="true" aria-pressed="true">Ø§Ù„ØµØ¨Ø§Ø­</button>
        <button id="tabEvening" aria-selected="false" aria-pressed="false">Ø§Ù„Ù…Ø³Ø§Ø¡</button>
      </div>
    </div>

    <div class="sc-bar" id="seekBar">
      <div class="sc-bar__bg"></div>
      <div class="sc-bar__fill" id="seekFill"></div>
      <div class="sc-bar__knob" id="seekKnob"></div>
    </div>

    <div class="sc-controls">
      <button id="playBtn" class="icon-btn primary">â–¶</button>
      <button id="pauseBtn" class="icon-btn" disabled>â¸</button>
      <button id="stopBtn" class="icon-btn ghost" disabled>â¹</button>
    </div>
  </div>

  <!-- Ù…Ù„ÙØ§Øª Ø§Ù„ØµÙˆØª -->
  <audio id="audioMorning" preload="auto" src="assets/audio/morning.mp3"></audio>
  <audio id="audioEvening" preload="auto" src="assets/audio/evening.mp3"></audio>
</div>
  <!-- 3) Ø£Ø²Ø±Ø§Ø± Ù†ÙˆØ¹ Ø§Ù„ØªÙˆØ²ÙŠØ¹Ø© -->
  <section class="card" aria-label="Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„ØªÙˆØ²ÙŠØ¹Ø©">
    <h2 style="margin-top:0">Ø§Ø®ØªØ§Ø±ÙŠ Ø§Ù„Ù†ÙˆØ¹</h2>
    <div class="inline">
      <button class="btn" data-type="keychain">Ù…Ø¯Ø§Ù„ÙŠØ©</button>
      <button class="btn" data-type="car-hanging">ØªØ¹Ù„ÙŠÙ‚Ø© Ø³ÙŠØ§Ø±Ø©</button>
    </div>
    <small>ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†ÙˆØ¹ Ù„Ø§Ø­Ù‚Ù‹Ø§ ÙÙŠ Ø®Ø·ÙˆØ© Ø§Ù„Ø·Ù„Ø¨.</small>
  </section>

  <!-- Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ... (Ø§Ù„Ø·Ù„Ø¨ / Ø§Ù„Ù…Ù„Ø®Øµ / Ù…Ù† Ù†Ø­Ù† / ... Ø¥Ù„Ø®) -->

  <div class="spacer"></div>
</main>
<script>
/* ================== State & Utilities (Secure) ================== */
const state = {
  theme: 'auto', // 'auto'|'nd'|'default'
  azkarKind: localStorage.getItem('azkarKind') || 'morning',
  rate: parseFloat(localStorage.getItem('rate') || '1'),
  order: { type: 'Ù…Ø¯Ø§Ù„ÙŠØ©', qty: 1, engrave: '', date: '' }
};
// sanitize
function sanitizeText(s=''){ return s.replace(/[<>]/g, '').trim(); }
function enc(s){return encodeURIComponent(s);}

/* ================== Theme: Auto September + Manual toggle ================== */
function isSeptember(){ const now = new Date(); return (now.getMonth()+1)===9; }
function applyTheme(){
  const body = document.body;
  const saved = localStorage.getItem('themePref') || 'auto';
  state.theme = saved;
  const useND = saved==='nd' ? true : saved==='default' ? false : isSeptember();
  body.classList.toggle('theme-nd', useND);
}
function toggleThemeManually(){
  const current = localStorage.getItem('themePref') || 'auto';
  const next = current==='auto' ? 'nd' : current==='nd' ? 'default' : 'auto';
  localStorage.setItem('themePref', next);
  applyTheme();
  const btn = document.querySelector('#themeToggle'); reflectThemeButton(btn);
}
function reflectThemeButton(btn){
  if(!btn) return;
  const pref = localStorage.getItem('themePref') || 'auto';
  btn.setAttribute('aria-pressed', (pref==='nd').toString());
}
applyTheme();

// assets/js/azkar-audio.js
(() => {
  // Ø£Ø¯ÙˆØ§Øª Ø³Ø±ÙŠØ¹Ø©
  const $ = (id) => document.getElementById(id);
  const fmt = (sec) => {
    if (!isFinite(sec)) return "00:00";
    const s = Math.max(0, Math.floor(sec));
    const m = Math.floor(s / 60), r = s % 60;
    return String(m).padStart(2, "0") + ":" + String(r).padStart(2, "0");
  };

  function initIfReady() {
    // Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
    const tabMorning = $("tabMorning");
    const tabEvening = $("tabEvening");
    const playBtn    = $("playBtn");
    const pauseBtn   = $("pauseBtn");
    const stopBtn    = $("stopBtn");
    const seekBar    = $("seekBar");
    const seekFill   = $("seekFill");
    const seekKnob   = $("seekKnob");
    const tNowEl     = $("tNow");
    const tTotalEl   = $("tTotal");
    const scTitleEl  = $("scTitle");

    // Ø§Ù„Ù…Ù‚Ø§Ø·Ø¹
    const audioMorning = $("audioMorning");
    const audioEvening = $("audioEvening");

    // Ù„Ùˆ Ø§Ù„ØµÙØ­Ø© Ø§Ù†Ø­Ù‚Ù†Øª ÙˆÙ„Ø³Ù‡ Ø¨Ø¹Ø¶ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù…Ø§ ÙˆØµÙ„ØªØŒ Ø§Ù†ØªØ¸Ø± Ø´ÙˆÙŠ
    if (![tabMorning, tabEvening, playBtn, pauseBtn, stopBtn, seekBar, seekFill, seekKnob, tNowEl, tTotalEl, scTitleEl, audioMorning, audioEvening].every(Boolean)) {
      return false;
    }

    let currentAudio = audioMorning;

    function reflectButtons(isPlaying) {
      playBtn.disabled  =  isPlaying;
      pauseBtn.disabled = !isPlaying;
      stopBtn.disabled  = !isPlaying && currentAudio.currentTime === 0;
    }
    function updateProgress() {
      const dur = currentAudio.duration;
      const cur = currentAudio.currentTime;
      const pct = (!isFinite(dur) || dur <= 0) ? 0 : (cur / dur) * 100;
      seekFill.style.width = pct + "%";
      seekKnob.style.left  = pct + "%";
      seekBar.setAttribute("aria-valuenow", String(Math.round(pct)));
      tNowEl.textContent   = fmt(cur);
      tTotalEl.textContent = fmt(dur);
    }
    function bind(a) {
      ["timeupdate","loadedmetadata","durationchange"].forEach(ev => a.addEventListener(ev, updateProgress));
      a.addEventListener("play",  () => reflectButtons(true));
      a.addEventListener("pause", () => reflectButtons(false));
      a.addEventListener("ended", () => { reflectButtons(false); a.currentTime = 0; updateProgress(); });
    }
    bind(audioMorning);
    bind(audioEvening);

    function selectTab(kind) {
      localStorage.setItem("azkarKind", kind);
      const isMorning = (kind === "morning");

      tabMorning.setAttribute("aria-pressed",  String(isMorning));
      tabMorning.setAttribute("aria-selected", String(isMorning));
      tabEvening.setAttribute("aria-pressed",  String(!isMorning));
      tabEvening.setAttribute("aria-selected", String(!isMorning));

      // Ø£ÙˆÙ‚Ù Ø§Ù„Ø­Ø§Ù„ÙŠ ÙˆØ§Ø±Ø¬Ø¹Ù‡ Ù„Ù„Ø¨Ø¯Ø§ÙŠØ©
      currentAudio.pause();
      currentAudio.currentTime = 0;

      currentAudio = isMorning ? audioMorning : audioEvening;
      scTitleEl.textContent = isMorning ? "Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­" : "Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡";

      reflectButtons(false);
      updateProgress();
    }

    // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ´ØºÙŠÙ„
    playBtn.addEventListener("click", () => { currentAudio.play().catch(()=>{}); });
    pauseBtn.addEventListener("click", () => currentAudio.pause());
    stopBtn.addEventListener("click", () => {
      currentAudio.pause();
      currentAudio.currentTime = 0;
      reflectButtons(false);
      updateProgress();
    });

    // Ø§Ù„ØªØ¨ÙˆÙŠØ¨
    tabMorning.addEventListener("click", () => selectTab("morning"));
    tabEvening.addEventListener("click", () => selectTab("evening"));

    // Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… (Ù†Ù‚Ø± + ÙƒÙŠØ¨ÙˆØ±Ø¯)
    function seekAt(clientX){
      const rect = seekBar.getBoundingClientRect();
      const x = Math.max(0, Math.min(rect.width, clientX - rect.left));
      const pct = rect.width ? (x / rect.width) : 0;
      if (isFinite(currentAudio.duration) && currentAudio.duration > 0){
        currentAudio.currentTime = pct * currentAudio.duration;
        updateProgress();
      }
    }
    seekBar.addEventListener("click", (e) => seekAt(e.clientX));
    seekBar.addEventListener("keydown", (e) => {
      if (!["ArrowLeft","ArrowRight","Home","End"].includes(e.key)) return;
      e.preventDefault();
      const dur = currentAudio.duration || 0;
      if (!isFinite(dur) || dur <= 0) return;
      const step = dur * 0.02; // 2%
      if (e.key === "ArrowRight") currentAudio.currentTime = Math.min(dur, currentAudio.currentTime + step);
      if (e.key === "ArrowLeft")  currentAudio.currentTime = Math.max(0,   currentAudio.currentTime - step);
      if (e.key === "Home")       currentAudio.currentTime = 0;
      if (e.key === "End")        currentAudio.currentTime = dur;
      updateProgress();
    });

    // ØªÙØ¹ÙŠÙ„ Ø£ÙˆÙ„ÙŠ
    selectTab(localStorage.getItem("azkarKind") || "morning");
    updateProgress();
    return true;
  }

  // Ù„Ø£Ù† home.html ÙŠÙØ­Ù‚Ù† Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ØŒ Ù†Ø±Ø§Ù‚Ø¨ DOM Ø¥Ù„Ù‰ Ø£Ù† ØªØ¸Ù‡Ø± Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø«Ù… Ù†Ù‡ÙŠØ¦
  function bootWhenReady() {
    if (initIfReady()) return;
    const obs = new MutationObserver(() => { if (initIfReady()) obs.disconnect(); });
    obs.observe(document.documentElement, { childList: true, subtree: true });
  }

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", bootWhenReady);
  } else {
    bootWhenReady();
  }
})();
/* ================== Quick checks ================== */
console.assert(isSeptember()===((new Date().getMonth()+1)===9), 'isSeptember check');
if (window.matchMedia('(prefers-reduced-motion: reduce)').matches){
  document.documentElement.style.scrollBehavior='auto';
}
</script>
